{
  "html": "<p>It is easy to run one Github action job after another by using the <a href=\"https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions#jobsjob_idneeds\">needs</a> keyword.</p>\n<pre><code class=\"hljs language-yml\"><span class=\"hljs-attr\">on:</span>\n  <span class=\"hljs-attr\">push:</span>\n    <span class=\"hljs-attr\">branches:</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">main</span>\n\n<span class=\"hljs-attr\">jobs:</span>\n  <span class=\"hljs-attr\">build:</span>\n    <span class=\"hljs-attr\">runs-on:</span> <span class=\"hljs-string\">ubuntu-latest</span>\n    <span class=\"hljs-attr\">steps:</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Run</span> <span class=\"hljs-string\">build</span>\n        <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">echo</span> <span class=\"hljs-string\">\"Running build steps...\"</span>\n\n  <span class=\"hljs-attr\">deploy:</span>\n    <span class=\"hljs-attr\">needs:</span> <span class=\"hljs-string\">build</span>\n    <span class=\"hljs-attr\">runs-on:</span> <span class=\"hljs-string\">ubuntu-latest</span>\n    <span class=\"hljs-attr\">steps:</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Checkout</span> <span class=\"hljs-string\">code</span>\n        <span class=\"hljs-attr\">uses:</span> <span class=\"hljs-string\">actions/checkout@v2</span>\n\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">Deploy</span> <span class=\"hljs-string\">code</span>\n        <span class=\"hljs-attr\">run:</span> <span class=\"hljs-string\">echo</span> <span class=\"hljs-string\">\"Deploying...\"</span>\n</code></pre>\n<p>In the example above, the <code>deploy</code> job has a <code>needs</code> directive that states that <code>deploy</code> can only run after <code>build</code> has been completed successfully.</p>\n<p>However, what about if we want an entire series of jobs in a separate GitHub action file to run after a job in a completely different file has run?</p>\n<h2>Repository Dispatch Events</h2>\n<p>Fortunately, it is possible to create a <a href=\"https://docs.github.com/en/free-pro-team@latest/rest/repos/repos?apiVersion=2022-11-28#create-a-repository-dispatch-event\">repository dispatch event</a> to trigger Github actions.</p>\n<p>A repository dispatch event is an endpoint that triggers a webhook event called <code>repository_dispatch</code>.</p>\n<p>Even more, fortunately, is that somebody has wrapped the finer details of triggering a <code>repository_dispatch</code> webhook event into an excellent GitHub action in this <a href=\"https://github.com/peter-evans/repository-dispatch/tree/v1/\">repo</a>.</p>\n<p>I faced a problem running <a href=\"https://www.webpagetest.org/\">webpage-test</a> on a staging site only after it was successfully deployed, and I wanted the logic segregated into its own Github action file.</p>\n<p>Below is the code that creates the dispatch event for an event I have named <code>trigger-webpage-test-for-frontendsupport</code></p>\n<pre><code class=\"hljs language-yml:build-and-deploy.yml\">- name: Trigger webpage test\n  uses: peter-evans/repository-dispatch@v1\n  with:\n    token: ${{ secrets.PAT }}\n    repository: dagda1/cuttingedge\n    event-type: trigger-webpage-test-for-frontendsupport\n</code></pre>\n<p>The action that runs web-page-test in a different file:</p>\n<pre><code class=\"hljs language-yml:webpage.test.yml\">name: run webpage test for frontendrescue\n\non:\n  repository_dispatch:\n    types: [trigger-webpage-test-for-frontendsupport]\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Checkout code\n        uses: actions/checkout@v2\n\n      - name: WebPageTest Staging\n        uses: WPO-Foundation/webpagetest-github-action@main\n        with:\n          apiKey: ${{ secrets.WPT_API_KEY }}\n          urls: |\n            https://staging.frontendrescue.com/\n            https://staging.frontendrescue.com/posts/2023-07-28-session-storage-playwright\n          label: 'GitHub Action Test'\n          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n</code></pre>\n<h2>GOTCHA ALERT!!!!</h2>\n<p>One catch is that repository dispatch events will only trigger an event if the workflow is committed to the default branch (usually master/main etc.).</p>\n<p>I initially wondered why the event was not triggered when committing to a feature branch, but once the action was in the <code>main</code> branch, the event got triggered.</p>\n<h2>Wrapping up</h2>\n<p>Repository dispatch events are an excellent way to generalise logic without resorting to the dreaded horrors of copying and pasting.</p>",
  "frontmatter": {
    "meta": {
      "title": "How to trigger a GitHub action from a different GitHub action file",
      "description": "trigger a github action from a different file by using repository dispatch events",
      "date": "2023-08-10T00:00:00.000Z",
      "image": "https://res.cloudinary.com/ddospxsc8/image/upload/v1691673246/github_wt7a34.png",
      "tags": ["github-actions", "continuous-integration", "devops"]
    }
  }
}
